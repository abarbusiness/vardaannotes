<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vardaan Comet - The Singularity</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;600&display=swap"
        rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            margin: 0;
            overflow-x: hidden;
            overflow-y: auto;
            background-color: #000;
            font-family: 'Montserrat', sans-serif;
        }

        /* --- CUSTOM SCROLLBAR --- */
        body::-webkit-scrollbar {
            width: 8px;
        }

        body::-webkit-scrollbar-thumb {
            background-color: #aa33ff;
            border-radius: 10px;
            border: 2px solid #0a0514;
        }

        body::-webkit-scrollbar-track {
            background-color: #0a0514;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        #flash-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            opacity: 0;
            pointer-events: none;
            z-index: 100;
        }

        /* --- UI OVERLAY --- */
        #hero-content {
            position: absolute;
            top: 15%;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            text-align: center;
            color: white;
            pointer-events: none;
            width: 100%;
            padding: 0 20px;
            box-sizing: border-box;
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 5vw;
            margin: 0;
            letter-spacing: 15px;
            font-weight: 700;
            perspective: 1000px;
            opacity: 0;
            animation: fadeIn 2s ease-out forwards 1.0s;
            line-height: 1.2;
        }

        h1 span {
            display: inline-block;
            pointer-events: auto;
            cursor: default;
            transition: transform 0.3s ease;
            background-image:
                radial-gradient(circle, #ffffff 0.5px, transparent 1px),
                radial-gradient(circle, #00ffff 1px, transparent 2px),
                radial-gradient(circle, rgba(136, 68, 255, 0.6) 1.5px, transparent 2.5px),
                linear-gradient(180deg, #ffffff 0%, #00ccff 40%, #5500ff 80%, #000033 100%);
            background-size: 15px 15px, 30px 30px, 50px 50px, 100% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
            filter: none;
            animation: cosmicDetailMove 12s linear infinite;
        }

        h1 span:hover {
            animation-play-state: paused;
            transform: scale(1.15) translateY(-5px);
            background-image: linear-gradient(180deg, #ffffff 0%, #e0c6ff 50%, #aa33ff 100%);
            text-shadow: 0 0 5px #aa33ff, 0 0 10px rgba(170, 51, 255, 0.6);
        }

        #divider-line {
            width: 25%;
            height: 1px;
            margin: 20px auto;
            opacity: 0;
            pointer-events: none;
            background: linear-gradient(90deg, transparent 0%, #ffffff 20%, #44aaff 50%, #ffffff 80%, transparent 100%);
            animation: fadeIn 1.5s ease-out forwards 1.3s;
            max-width: 400px;
            box-shadow: 0 0 8px rgba(68, 170, 255, 0.5);
        }

        h2 {
            font-size: 1rem;
            letter-spacing: 3px;
            color: #dcbfff;
            margin-top: 20px;
            opacity: 0;
            font-weight: 600;
            text-shadow: 0 0 10px rgba(136, 68, 255, 0.6);
            animation: slideUp 2s ease-out forwards 1.5s;
        }

        /* --- DASHBOARD CONTAINER --- */
        #main-dashboard {
            position: absolute;
            top: 100vh;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            width: 90%;
            max-width: 1100px;
            height: auto;
            background-color: rgba(10, 5, 20, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(170, 51, 255, 0.4);
            border-radius: 16px;
            padding: 40px 30px;
            box-shadow: 0 0 30px rgba(10, 5, 20, 0.9), 0 0 15px rgba(170, 51, 255, 0.2);
            color: white;
            pointer-events: auto;
            opacity: 0;
            animation: fadeIn 2s ease-out forwards 2.5s;
            margin-bottom: 50px;
        }

        .section-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            margin-bottom: 25px;
            margin-top: 40px;
            color: #00ffff;
            text-align: center;
            text-shadow: 0 0 10px #00ffff, 0 0 5px rgba(0, 255, 255, 0.6);
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(0, 255, 255, 0.2);
        }

        .board-title {
            font-size: 1.2rem;
            color: #ffffff;
            margin: 20px 0 10px 0;
            font-weight: 700;
            letter-spacing: 2px;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.8), 0 0 15px rgba(170, 51, 255, 0.5);
            border-left: 3px solid #00ffff;
            padding-left: 10px;
        }

        /* --- BUTTONS --- */
        .class-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .class-btn {
            background: linear-gradient(135deg, rgba(40, 0, 80, 0.6) 0%, rgba(80, 0, 160, 0.8) 100%);
            border: 1px solid rgba(170, 51, 255, 0.6);
            border-radius: 8px;
            padding: 12px;
            color: white;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(170, 51, 255, 0.2);
        }

        .class-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 0 20px rgba(170, 51, 255, 0.8), 0 0 10px rgba(255, 255, 255, 0.4);
            background: linear-gradient(135deg, rgba(80, 0, 160, 0.9) 0%, rgba(130, 50, 255, 0.9) 100%);
            border-color: #dcbfff;
        }

        .class-btn.icse {
            background: linear-gradient(135deg, rgba(0, 40, 60, 0.6) 0%, rgba(0, 100, 140, 0.8) 100%);
            border: 1px solid rgba(0, 255, 255, 0.5);
            color: #e0faff;
        }

        .class-btn.icse:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.6), 0 0 10px rgba(255, 255, 255, 0.4);
            background: linear-gradient(135deg, rgba(0, 100, 140, 0.9) 0%, rgba(0, 200, 255, 0.9) 100%);
            border-color: #ffffff;
            color: #fff;
        }

        /* --- FEATURES GRID --- */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .feature-card {
            background: rgba(20, 20, 40, 0.6);
            border: 1px solid rgba(0, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: transform 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            border-color: rgba(0, 255, 255, 0.4);
        }

        .feature-icon {
            font-size: 2rem;
            color: #aa33ff;
            margin-bottom: 15px;
        }

        .feature-title {
            font-weight: 700;
            color: #fff;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .feature-desc {
            color: #ccc;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* --- SLIDER / CAROUSEL STYLES --- */
        .slider-viewport {
            overflow: hidden;
            width: 100%;
            position: relative;
            padding: 10px 0;
            /* Mask to fade out edges */
            -webkit-mask-image: linear-gradient(to right, transparent 0%, black 10%, black 90%, transparent 100%);
            mask-image: linear-gradient(to right, transparent 0%, black 10%, black 90%, transparent 100%);
        }

        .slider-track {
            display: flex;
            gap: 30px;
            width: max-content;
            /* Animation for continuous scrolling */
            animation: scroll 35s linear infinite;
        }

        /* Pause on hover to read */
        .slider-track:hover {
            animation-play-state: paused;
        }

        .testimonial-card {
            width: 320px;
            /* Fixed width for cards in slider */
            flex-shrink: 0;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 25px;
            position: relative;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .testimonial-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(170, 51, 255, 0.5);
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(170, 51, 255, 0.2);
        }

        .quote-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            color: rgba(0, 255, 255, 0.2);
            font-size: 1.5rem;
        }

        .testimonial-text {
            font-style: italic;
            color: #e0e0e0;
            margin-bottom: 20px;
            font-size: 1rem;
            line-height: 1.6;
        }

        .student-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .student-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #aa33ff, #00ffff);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .student-details {
            display: flex;
            flex-direction: column;
        }

        .student-name {
            color: #fff;
            font-weight: 700;
            font-size: 0.95rem;
        }

        .student-class {
            color: #aa33ff;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
        }

        @keyframes scroll {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-50%);
            }

            /* Moves exactly half way (the cloned set) */
        }

        /* --- PROFILE SECTION --- */
        .profile-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .profile-img-box {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: linear-gradient(135deg, #aa33ff, #00ffff);
            padding: 4px;
            /* Border width */
            box-shadow: 0 0 20px rgba(170, 51, 255, 0.5);
            flex-shrink: 0;
        }

        .profile-img-placeholder {
            width: 100%;
            height: 100%;
            background-color: #1a1a2e;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 3rem;
            overflow: hidden;
        }

        .profile-content {
            flex: 1;
            min-width: 300px;
            text-align: left;
        }

        .profile-name {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            color: #fff;
            margin-bottom: 5px;
        }

        .profile-role {
            color: #00ffff;
            font-weight: 600;
            margin-bottom: 10px;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }

        .profile-bio {
            color: #ddd;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        /* --- MESSAGE CARD & HEART ANIMATION --- */
        .message-card {
            background: linear-gradient(135deg, rgba(20, 0, 40, 0.8), rgba(0, 20, 40, 0.8));
            border: 1px solid #dcbfff;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            position: relative;
            margin-top: 20px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
        }

        .message-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #ffffff;
            font-weight: 300;
        }

        .heart-anim {
            color: #ff3366;
            animation: pulseHeart 1.5s infinite ease-in-out;
            display: inline-block;
            margin: 0 5px;
            font-size: 1.2rem;
            vertical-align: middle;
            text-shadow: 0 0 15px rgba(255, 51, 102, 0.8);
        }

        @keyframes pulseHeart {
            0% {
                transform: scale(1);
                opacity: 0.8;
            }

            50% {
                transform: scale(1.3);
                opacity: 1;
            }

            100% {
                transform: scale(1);
                opacity: 0.8;
            }
        }

        .highlight {
            color: #00ffff;
            font-weight: 600;
        }

        .highlight-orange {
            color: #ff8c00;
            font-weight: 600;
            text-shadow: 0 0 10px rgba(255, 140, 0, 0.4);
        }

        /* --- FOOTER --- */
        .site-footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            color: #888;
            font-size: 0.8rem;
        }

        .footer-brand {
            color: #fff;
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }


        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            h1 {
                font-size: 6.5vw;
            }

            #main-dashboard {
                top: 100vh;
                width: 95%;
                padding: 25px 15px;
            }

            .class-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .profile-container {
                text-align: center;
            }

            .profile-content {
                text-align: center;
            }
        }

        @keyframes cosmicDetailMove {
            0% {
                background-position: 0px 0px, 0px 0px, 0px 0px, 50% 50%;
            }

            100% {
                background-position: 0px -100px, 20px -50px, -10px -30px, 50% 50%;
            }
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
                filter: blur(5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
                filter: blur(0);
            }
        }

        .vignette {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, transparent 40%, #000000 100%);
            z-index: 5;
            pointer-events: none;
        }
    </style>

    <script type="importmap">
        {
            "imports": {
                "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
                "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
            }
        }
    </script>
</head>

<body>
    <<<<<<< HEAD <div class="vignette">
        </div>
        <div id="flash-overlay"></div>

        <div id="hero-content">
            <h1 id="main-title">VARDAAN COMET</h1>
            <div id="divider-line"></div>
            <h2>Best & Premium Study Resources Platform | A Vardaan Learning Initiative</h2>
        </div>

        <div id="main-dashboard">

            <!-- CLASS SELECTION -->
            <div class="section-title" style="margin-top: 0;">SELECT YOUR CLASS</div>

            <div class="board-title">CBSE</div>
            <div class="class-grid">
                <a href="CBSE/Class 6/Class6.html" class="class-btn">Class 6</a>
                <a href="CBSE/Class 7/Class7.html" class="class-btn">Class 7</a>
                <a href="CBSE/Class 8/Class8.html" class="class-btn">Class 8</a>
                <a href="CBSE/Class 9/Class9.html" class="class-btn">Class 9</a>
                <a href="CBSE/Class10/Class10.html" class="class-btn">Class 10</a>
                <a href="#" class="class-btn">Class 11</a>
                <a href="#" class="class-btn">Class 12</a>
            </div>

            <div class="board-title">ICSE</div>
            <div class="class-grid">
                <a href="ICSE/Class 6/Class6.html" class="class-btn icse">Class 6</a>
                <a href="ICSE/Class 7/Class7.html" class="class-btn icse">Class 7</a>
                <a href="ICSE/Class 8/Class8.html" class="class-btn icse">Class 8</a>
                <a href="ICSE/Class 9/Class9.html" class="class-btn icse">Class 9</a>
                <a href="ICSE/Class 10/Class10.html" class="class-btn icse">Class 10</a>
                <a href="ICSE/Class 11/Class11.html" class="class-btn icse">Class 11</a>
                <a href="ICSE/Class 12/Class12.html" class="class-btn icse">Class 12</a>
            </div>

            <!-- WHY VARDAAN NOTES? -->
            <div class="section-title">WHY VARDAAN NOTES?</div>
            <div class="features-grid">
                <div class="feature-card">
                    <i class="fas fa-brain feature-icon"></i>
                    <div class="feature-title">Concept Clarity</div>
                    <div class="feature-desc">We break down complex topics into simple, digestible stories that stick
                        with you forever.</div>
                </div>
                <div class="feature-card">
                    <i class="fas fa-bullseye feature-icon"></i>
                    <div class="feature-title">Exam Focused</div>
                    <div class="feature-desc">Curated specifically for Board Exams with previous year questions and
                        high-probability topics.</div>
                </div>
                <div class="feature-card">
                    <i class="fas fa-pencil-ruler feature-icon"></i>
                    <div class="feature-title">Visual Learning</div>
                    <div class="feature-desc">Packed with diagrams, flowcharts, and mind-maps to help visual learners
                        grasp faster.</div>
                </div>
            </div>

            <!-- TESTIMONIALS SLIDER -->
            <div class="section-title">STUDENT STORIES</div>
            <div class="slider-viewport">
                <div class="slider-track" id="testimonialTrack">

                    <!-- Mock Student 1 -->
                    <div class="testimonial-card">
                        <i class="fas fa-quote-right quote-icon"></i>
                        <div class="testimonial-text">"Vardaan notes changed how I study Physics. The Singularity
                            concept actually made sense for the first time!"</div>
                        <div class="student-info">
                            <div class="student-avatar">R</div>
                            <div class="student-details">
                                <div class="student-name">Rohan Sharma</div>
                                <div class="student-class">Class 10 CBSE</div>
                            </div>
                        </div>
                    </div>

                    <!-- Mock Student 2 -->
                    <div class="testimonial-card">
                        <i class="fas fa-quote-right quote-icon"></i>
                        <div class="testimonial-text">"The detailed diagrams in the Biology notes helped me score top
                            marks in my pre-boards. Highly recommended."</div>
                        <div class="student-info">
                            <div class="student-avatar">P</div>
                            <div class="student-details">
                                <div class="student-name">Priya Malhotra</div>
                                <div class="student-class">Class 8 CBSE</div>
                            </div>
                        </div>
                    </div>

                    <!-- Mock Student 3 -->
                    <div class="testimonial-card">
                        <i class="fas fa-quote-right quote-icon"></i>
                        <div class="testimonial-text">"I struggled with Chemistry until I found these notes. Short,
                            crisp, and to the point."</div>
                        <div class="student-info">
                            <div class="student-avatar">A</div>
                            <div class="student-details">
                                <div class="student-name">Aryan Kumar</div>
                                <div class="student-class">Class 9 ICSE</div>
                            </div>
                        </div>
                    </div>

                    <!-- Mock Student 4 -->
                    <div class="testimonial-card">
                        <i class="fas fa-quote-right quote-icon"></i>
                        <div class="testimonial-text">"Maths theorems felt so easy after reading these notes. Ankit
                            Bhaiya's way of explaining is magic."</div>
                        <div class="student-info">
                            <div class="student-avatar">S</div>
                            <div class="student-details">
                                <div class="student-name">Sanya Gupta</div>
                                <div class="student-class">Class 10 CBSE</div>
                            </div>
                        </div>
                    </div>

                    <!-- Mock Student 5 -->
                    <div class="testimonial-card">
                        <i class="fas fa-quote-right quote-icon"></i>
                        <div class="testimonial-text">"The best resource for ICSE history. Timeline charts made
                            remembering dates super easy."</div>
                        <div class="student-info">
                            <div class="student-avatar">V</div>
                            <div class="student-details">
                                <div class="student-name">Vikram Singh</div>
                                <div class="student-class">Class 9 ICSE</div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- INTRODUCING ANKIT BHAIYA -->
            <div class="section-title">MEET THE MENTOR</div>
            <div class="profile-container">
                <div class="profile-img-box">
                    <!-- Placeholder for profile picture -->
                    <div class="profile-img-placeholder">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
                <div class="profile-content">
                    <div class="profile-name">Ankit Bhaiya</div>
                    <div class="profile-role">CO-FOUNDER, VARDAAN LEARNING INSTITUTE</div>
                    <div class="profile-bio">
                        A passionate educator and mentor dedicated to revolutionizing the way students perceive
                        education. Currently pursuing his B.Tech at <strong>NIT Jamshedpur</strong>, Ankit Bhaiya
                        believes in blending academic excellence with real-world understanding.
                    </div>
                </div>
            </div>

            <!-- MESSAGE FROM ANKIT BHAIYA -->
            <div class="section-title">A MESSAGE FROM THE HEART <i class="fas fa-heart heart-anim"></i></div>
            <div class="message-card">
                <p class="message-text">
                    "We are on a mission to discover a way of teaching that works for <span class="highlight">every
                        student</span> — not just toppers, but especially those who are struggling. At <span
                        class="highlight-orange">Vardaan</span>, no one is left behind. I dream of building a river of
                    <span class="highlight-orange">knowledge</span>, <span class="highlight-orange">values</span>, and
                    <span class="highlight-orange">growth</span> — where every student, no matter their level, can take
                    a dip and come out stronger."
                </p>
            </div>

            <!-- FOOTER -->
            <footer class="site-footer">
                <div class="footer-brand">VARDAAN LEARNING INSTITUTE</div>
                <p>&copy; 2025 All Rights Reserved. Empowering Education in India.</p>
            </footer>

        </div>

        <div id="canvas-container"></div>

        <script type="module">
            import * as THREE from 'three';
            import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
            import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
            import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

            // --- 0. TEXT SPLITTING LOGIC ---
            const title = document.getElementById('main-title');
            const text = title.textContent;
            title.innerHTML = '';

            [...text].forEach((char, index) => {
                const span = document.createElement('span');
                span.textContent = char === ' ' ? '\u00A0' : char;
                span.style.animationDelay = `-${index * 2}s`;
                title.appendChild(span);
            });

            // --- 1. SLIDER CLONING LOGIC (Seamless Loop) ---
            // This script duplicates the cards so the animation has enough content to scroll seamlessly
            const track = document.getElementById('testimonialTrack');
            const cards = Array.from(track.children);

            // Clone the cards and append them to the end
            cards.forEach(card => {
                const clone = card.cloneNode(true);
                track.appendChild(clone);
            });


            // --- 2. THREE.JS SETUP ---
            const container = document.getElementById('canvas-container');
            const scene = new THREE.Scene();
            scene.fog = new THREE.FogExp2(0x000000, 0.002);

            const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 10000);
            const startZ = 150;
            const startY = 0;
            const targetZ = 90;
            const targetY = 25;

            camera.position.set(0, startY, startZ); // Start further back
            camera.lookAt(0, 0, 0);

            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: false });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.2;
            container.appendChild(renderer.domElement);

            // --- 3. POST-PROCESSING ---
            const composer = new EffectComposer(renderer);
            const renderPass = new RenderPass(scene, camera);
            composer.addPass(renderPass);

            const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
            bloomPass.threshold = 0.1;
            bloomPass.strength = 2.5;
            bloomPass.radius = 0.8;
            composer.addPass(bloomPass);

            // --- 4. BIG BANG SYSTEM ---
            const seedGeo = new THREE.SphereGeometry(0.5, 32, 32);
            const seedMat = new THREE.MeshBasicMaterial({ color: 0xffffff });
            const bangSeed = new THREE.Mesh(seedGeo, seedMat);
            scene.add(bangSeed);

            const bangCount = 4000;
            const bangGeo = new THREE.BufferGeometry();
            const bangPos = new Float32Array(bangCount * 3);
            const bangVel = new Float32Array(bangCount * 3);
            const bangColor = new Float32Array(bangCount * 3);

            for (let i = 0; i < bangCount; i++) {
                bangPos[i * 3] = 0; bangPos[i * 3 + 1] = 0; bangPos[i * 3 + 2] = 0;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);
                const speed = 2 + Math.random() * 4;
                bangVel[i * 3] = speed * Math.sin(phi) * Math.cos(theta);
                bangVel[i * 3 + 1] = speed * Math.sin(phi) * Math.sin(theta);
                bangVel[i * 3 + 2] = speed * Math.cos(phi);
                const c = new THREE.Color();
                if (Math.random() > 0.5) c.setHex(0xffffff);
                else c.setHex(0x00ffff);
                bangColor[i * 3] = c.r; bangColor[i * 3 + 1] = c.g; bangColor[i * 3 + 2] = c.b;
            }

            bangGeo.setAttribute('position', new THREE.BufferAttribute(bangPos, 3));
            bangGeo.setAttribute('color', new THREE.BufferAttribute(bangColor, 3));
            const bangMat = new THREE.PointsMaterial({
                size: 2, vertexColors: true, blending: THREE.AdditiveBlending, transparent: true, opacity: 1
            });
            const bangParticles = new THREE.Points(bangGeo, bangMat);
            bangParticles.visible = false;
            scene.add(bangParticles);

            const mainSceneGroup = new THREE.Group();
            mainSceneGroup.visible = false;
            scene.add(mainSceneGroup);

            // --- 5. COSMIC PLANET SHADERS (Central Planet) ---
            const planetVertexShader = `
            varying vec2 vUv; varying vec3 vNormal; varying vec3 vViewPosition;
            void main() {
                vUv = uv; vNormal = normalize(normalMatrix * normal);
                vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
                vViewPosition = -mvPosition.xyz;
                gl_Position = projectionMatrix * mvPosition;
            }
        `;
            const planetFragmentShader = `
            uniform float uTime; varying vec2 vUv; varying vec3 vNormal; varying vec3 vViewPosition;
            
            // Simplex Noise
            vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
            vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
            vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }
            float snoise(vec2 v) {
                const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439);
                vec2 i = floor(v + dot(v, C.yy) ); vec2 x0 = v - i + dot(i, C.xx);
                vec2 i1; i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
                vec4 x12 = x0.xyxy + C.xxzz; x12.xy -= i1; i = mod289(i);
                vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));
                vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
                m = m*m ; m = m*m ;
                vec3 x = 2.0 * fract(p * C.www) - 1.0; vec3 h = abs(x) - 0.5; vec3 ox = floor(x + 0.5);
                vec3 a0 = x - ox; m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
                vec3 g; g.x = a0.x * x0.x + h.x * x0.y; g.yz = a0.yz * x12.xz + h.yz * x12.yw;
                return 130.0 * dot(m, g);
            }

            // Fractal Brownian Motion for terrain detail
            float fbm(vec2 p) {
                float value = 0.0;
                float amplitude = 0.5;
                for (int i = 0; i < 5; i++) {
                    value += amplitude * snoise(p);
                    p *= 2.0;
                    amplitude *= 0.5;
                }
                return value;
            }

            void main() {
                // Sphere mapping
                vec3 viewDir = normalize(vViewPosition);
                vec3 normal = normalize(vNormal);
                float ndotv = dot(normal, viewDir);
                
                // Rotational coordinates
                vec2 uv = vUv;
                uv.x -= uTime * 0.02; // Planet rotation
                
                // --- CONTINENTAL NOISE (Earth-like shapes) ---
                float terrain = fbm(uv * 3.0 + vec2(0.0, 0.0));
                
                // --- CLOUD NOISE (Jupiter-like bands + swirling) ---
                vec2 cloudUV = vUv;
                cloudUV.x -= uTime * 0.05; // Clouds move faster
                cloudUV.y += snoise(cloudUV * 4.0 + uTime * 0.1) * 0.1; // Swirling distortion
                float clouds = fbm(cloudUV * 6.0);
                
                // --- COLOR PALETTE ---
                vec3 deepOcean = vec3(0.0, 0.05, 0.2); // Dark Blue
                vec3 shallowOcean = vec3(0.0, 0.4, 0.8); // Electric Blue
                vec3 land = vec3(0.0, 0.8, 0.5); // Teal/Greenish Land
                vec3 mountain = vec3(0.8, 0.8, 1.0); // Icy peaks
                
                // Mix Terrain Colors
                vec3 surfaceCol = mix(deepOcean, shallowOcean, smoothstep(-0.4, -0.1, terrain));
                surfaceCol = mix(surfaceCol, land, smoothstep(-0.1, 0.1, terrain));
                surfaceCol = mix(surfaceCol, mountain, smoothstep(0.4, 0.6, terrain));
                
                // Add Clouds
                float cloudCover = smoothstep(0.2, 0.6, clouds);
                surfaceCol = mix(surfaceCol, vec3(1.0), cloudCover * 0.8);
                
                // --- ATMOSPHERE (Fresnel Glow) ---
                float fresnel = pow(1.0 - ndotv, 3.0);
                vec3 atmosphere = vec3(0.2, 0.6, 1.0) * fresnel * 2.0; // Blue glowing atmosphere
                
                // Shadow (Fake lighting from top-left)
                float light = dot(normal, normalize(vec3(1.0, 1.0, 1.0))) * 0.5 + 0.5;
                surfaceCol *= (0.2 + 0.8 * light); // Ambient + Diffuse

                gl_FragColor = vec4(surfaceCol + atmosphere, 1.0);
            }
        `;

            const holeGeo = new THREE.SphereGeometry(12, 64, 64);
            const holeMat = new THREE.ShaderMaterial({
                uniforms: { uTime: { value: 0 } },
                vertexShader: planetVertexShader,
                fragmentShader: planetFragmentShader
            });
            const planetMesh = new THREE.Mesh(holeGeo, holeMat);
            mainSceneGroup.add(planetMesh);

            // Accretion Disk / Asteroid Belt
            const pCount = 25000;
            const pGeo = new THREE.BufferGeometry();
            const pPos = new Float32Array(pCount * 3);
            const pCol = new Float32Array(pCount * 3);
            const pSizes = new Float32Array(pCount);
            const pSpeed = new Float32Array(pCount);
            const pAngle = new Float32Array(pCount);
            const pRadius = new Float32Array(pCount);
            const colorCore = new THREE.Color(0xffffff);
            const colorInner = new THREE.Color(0x00ffff);
            const colorMid = new THREE.Color(0x8800ff);
            const colorOuter = new THREE.Color(0x000088);
            for (let i = 0; i < pCount; i++) {
                const r = 16 + (1 - Math.pow(Math.random(), 3)) * 60; // Pushed out slightly
                const theta = Math.random() * Math.PI * 2;
                const x = Math.cos(theta) * r; const z = Math.sin(theta) * r;
                const y = (Math.random() - 0.5) * (r * 0.08);
                pPos[i * 3] = x; pPos[i * 3 + 1] = y; pPos[i * 3 + 2] = z;
                pRadius[i] = r; pAngle[i] = theta; pSpeed[i] = (25 / r) * 0.003;
                const normalizedR = (r - 16) / 60;
                const c = new THREE.Color();
                if (normalizedR < 0.1) c.copy(colorCore).lerp(colorInner, normalizedR / 0.1);
                else if (normalizedR < 0.4) c.copy(colorInner).lerp(colorMid, (normalizedR - 0.1) / 0.3);
                else c.copy(colorMid).lerp(colorOuter, (normalizedR - 0.4) / 0.6);
                pCol[i * 3] = c.r; pCol[i * 3 + 1] = c.g; pCol[i * 3 + 2] = c.b;
                pSizes[i] = Math.random() * 0.4 + 0.1;
            }
            pGeo.setAttribute('position', new THREE.BufferAttribute(pPos, 3));
            pGeo.setAttribute('color', new THREE.BufferAttribute(pCol, 3));
            pGeo.setAttribute('size', new THREE.BufferAttribute(pSizes, 1));
            const sprite = new THREE.TextureLoader().load('https://threejs.org/examples/textures/sprites/spark1.png');
            const pMat = new THREE.PointsMaterial({
                vertexColors: true, map: sprite, blending: THREE.AdditiveBlending, depthWrite: false, transparent: true, opacity: 0.9, sizeAttenuation: true
            });
            const accretionDisk = new THREE.Points(pGeo, pMat);
            mainSceneGroup.add(accretionDisk);

            // --- BACKGROUND CELESTIAL BODIES (Moons) ---
            const bgMoonVertexShader = `
            varying vec2 vUv; varying vec3 vNormal; varying vec3 vViewPosition;
            void main() {
                vUv = uv; vNormal = normalize(normalMatrix * normal);
                vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
                vViewPosition = -mvPosition.xyz;
                gl_Position = projectionMatrix * mvPosition;
            }
        `;

            const bgMoonFragmentShader = `
            uniform float uTime; uniform vec3 uColor;
            varying vec2 vUv; varying vec3 vNormal; varying vec3 vViewPosition;

            // Simplex Noise
            vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
            vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
            vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }
            float snoise(vec2 v) {
                const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439);
                vec2 i = floor(v + dot(v, C.yy) ); vec2 x0 = v - i + dot(i, C.xx);
                vec2 i1; i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
                vec4 x12 = x0.xyxy + C.xxzz; x12.xy -= i1; i = mod289(i);
                vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));
                vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
                m = m*m ; m = m*m ;
                vec3 x = 2.0 * fract(p * C.www) - 1.0; vec3 h = abs(x) - 0.5; vec3 ox = floor(x + 0.5);
                vec3 a0 = x - ox; m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
                vec3 g; g.x = a0.x * x0.x + h.x * x0.y; g.yz = a0.yz * x12.xz + h.yz * x12.yw;
                return 130.0 * dot(m, g);
            }

            // Fractal Brownian Motion for realistic lunar terrain
            float fbm(vec2 p) {
                float value = 0.0;
                float amp = 0.55;
                float freq = 1.0;
                for (int i = 0; i < 6; i++) {
                    value += amp * snoise(p * freq);
                    p *= 2.1;
                    amp *= 0.45;
                }
                return value;
            }

            void main() {
                vec3 viewDir = normalize(vViewPosition);
                vec3 normal = normalize(vNormal);
                
                // 1. Geography Generation (Maria vs Highlands)
                float continents = snoise(vUv * 1.8 + 5.0); 
                float detail = fbm(vUv * 6.0); 
                float height = continents * 0.6 + detail * 0.4;
                
                // 2. Realistic Colors
                vec3 darkMaria = vec3(0.15, 0.15, 0.18);
                vec3 lightHighlands = vec3(0.75, 0.73, 0.70);
                
                vec3 surfaceCol = mix(darkMaria, lightHighlands, smoothstep(-0.2, 0.3, height));
                surfaceCol *= (0.8 + 0.4 * detail);

                // 3. Lighting (Sunlight)
                vec3 lightDir = normalize(vec3(0.8, 0.5, 1.0));
                float diff = max(0.01, dot(normal, lightDir));
                float bump = smoothstep(0.4, 0.6, detail) * (1.0 - diff); 
                surfaceCol -= bump * 0.2;

                vec3 finalCol = surfaceCol * diff;
                
                // 4. Subtle Atmosphere/Glow (Aesthetic touch)
                float fresnel = pow(1.0 - dot(normal, viewDir), 4.0);
                float litFresnel = fresnel * diff; 
                finalCol += uColor * litFresnel * 0.4; 

                gl_FragColor = vec4(finalCol, 1.0);
            }
        `;

            // --- PURPLE PLANET SHADERS ---

            const glowingPlanetVertexShader = `
            varying vec2 vUv; varying vec3 vNormal; varying vec3 vViewPosition;
            void main() {
                vUv = uv; vNormal = normalize(normalMatrix * normal);
                vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
                vViewPosition = -mvPosition.xyz;
                gl_Position = projectionMatrix * mvPosition;
            }
        `;

            const glowingPlanetFragmentShader = `
            uniform float uTime; uniform vec3 uColor;
            varying vec2 vUv; varying vec3 vNormal; varying vec3 vViewPosition;

            // Simplex Noise (Cleaned up)
            vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
            vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
            vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }
            float snoise(vec2 v) {
                const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439);
                vec2 i = floor(v + dot(v, C.yy) ); vec2 x0 = v - i + dot(i, C.xx);
                vec2 i1; i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
                vec4 x12 = x0.xyxy + C.xxzz; x12.xy -= i1; i = mod289(i);
                vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));
                vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
                m = m*m ; m = m*m ;
                vec3 x = 2.0 * fract(p * C.www) - 1.0; vec3 h = abs(x) - 0.5; vec3 ox = floor(x + 0.5);
                vec3 a0 = x - ox; m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
                vec3 g; g.x = a0.x * x0.x + h.x * x0.y; g.yz = a0.yz * x12.xz + h.yz * x12.yw;
                return 130.0 * dot(m, g);
            }

            // Fractal Brownian Motion for terrain detail
            float fbm(vec2 p) {
                float value = 0.0;
                float amplitude = 0.5;
                for (int i = 0; i < 5; i++) {
                    value += amplitude * snoise(p);
                    p *= 2.0;
                    amplitude *= 0.5;
                }
                return value;
            }

            void main() {
                vec3 viewDir = normalize(vViewPosition);
                vec3 normal = normalize(vNormal);
                
                // Rotational coordinates (Subtle speed for realism)
                vec2 uv = vUv;
                uv.x -= uTime * 0.01; 
                
                // Generate Terrain/Cloud noise (Used for continental look)
                float terrain = fbm(uv * 3.0 + vec2(0.0, 0.0));
                float clouds = fbm(uv * 6.0 + uTime * 0.005); // Very slow cloud movement for distance realism
                
                // Color Mapping (Using the planet's base color UColor)
                vec3 darkBase = uColor * 0.15; // Shadow base
                vec3 lightHighlight = uColor * 0.7; // Continental highlight
                
                // Mix Terrain Colors
                vec3 surfaceCol = mix(darkBase, lightHighlight, smoothstep(-0.4, 0.1, terrain));
                
                // Add White Clouds
                float cloudCover = smoothstep(0.3, 0.6, clouds);
                surfaceCol = mix(surfaceCol, vec3(1.0), cloudCover * 0.4); 
                
                // Shadow (Lighting from top-right)
                vec3 lightDir = normalize(vec3(0.8, 0.5, 1.0));
                float diff = max(0.1, dot(normal, lightDir));
                surfaceCol *= (0.2 + 0.8 * diff); // Apply natural shadow

                // --- SUBTLE GLOW (FRESNEL) ---
                float fresnel = pow(1.0 - dot(normal, viewDir), 2.5);
                surfaceCol += uColor * fresnel * 0.4; 

                gl_FragColor = vec4(surfaceCol, 1.0);
            }
        `;

            const bgMoons = [];

            // Moon 1: Top Left (Natural Lunar Grey)
            const moonGeo1 = new THREE.SphereGeometry(6, 64, 64);
            const moonMat1 = new THREE.ShaderMaterial({
                uniforms: { uTime: { value: 0 }, uColor: { value: new THREE.Color(0xaaccff) } }, // Slight blue tint for aesthetics
                vertexShader: bgMoonVertexShader,
                fragmentShader: bgMoonFragmentShader
            });
            const moon1 = new THREE.Mesh(moonGeo1, moonMat1);
            moon1.position.set(-90, 50, -60); // Upper Left
            moon1.rotation.y = 2.0; // Rotate to show different face
            mainSceneGroup.add(moon1);
            bgMoons.push(moon1);

            // Moon 2: Top Right (Distant Pale Moon)
            const moonGeo2 = new THREE.SphereGeometry(4, 64, 64);
            const moonMat2 = new THREE.ShaderMaterial({
                uniforms: { uTime: { value: 0 }, uColor: { value: new THREE.Color(0xffeedd) } }, // Slight warm tint
                vertexShader: bgMoonVertexShader,
                fragmentShader: bgMoonFragmentShader
            });
            const moon2 = new THREE.Mesh(moonGeo2, moonMat2);
            moon2.position.set(100, 40, -80); // Upper Right
            moon2.rotation.y = -1.0;
            mainSceneGroup.add(moon2);
            bgMoons.push(moon2);

            // --- Purple Planet (Lower Left) ---
            const purpleGeo = new THREE.SphereGeometry(7, 64, 64); // Slightly larger
            const purpleMat = new THREE.ShaderMaterial({
                uniforms: {
                    uTime: { value: 0 },
                    uColor: { value: new THREE.Color(0xaa33ff) } // Bright purple color
                },
                vertexShader: glowingPlanetVertexShader,
                fragmentShader: glowingPlanetFragmentShader
            });
            const purplePlanet = new THREE.Mesh(purpleGeo, purpleMat);
            purplePlanet.position.set(-150, -40, -120); // Distant, lower left
            purplePlanet.rotation.z = Math.PI * 0.1;
            mainSceneGroup.add(purplePlanet);
            bgMoons.push(purplePlanet); // Add to the animation loop


            // Stars
            const starGeo = new THREE.BufferGeometry();
            const starCount = 6000;
            const starPos = new Float32Array(starCount * 3);
            const starCol = new Float32Array(starCount * 3);
            for (let i = 0; i < starCount * 3; i += 3) {
                const r = 1000 + Math.random() * 1000;
                const theta = Math.random() * Math.PI * 2;
                const phi = Math.acos(2 * Math.random() - 1);
                starPos[i] = r * Math.sin(phi) * Math.cos(theta);
                starPos[i + 1] = r * Math.sin(phi) * Math.sin(theta);
                starPos[i + 2] = r * Math.cos(phi);
                const c = new THREE.Color().setHSL(0.6 + Math.random() * 0.1, 0.8, 0.8);
                starCol[i] = c.r; starCol[i + 1] = c.g; starCol[i + 2] = c.b;
            }
            starGeo.setAttribute('position', new THREE.BufferAttribute(starPos, 3));
            starGeo.setAttribute('color', new THREE.BufferAttribute(starCol, 3));
            const starMat = new THREE.PointsMaterial({ size: 1.5, vertexColors: true, transparent: true, opacity: 0.8 });
            const stars = new THREE.Points(starGeo, starMat);
            mainSceneGroup.add(stars);

            // --- 7. ANIMATION STATE ---
            const clock = new THREE.Clock();
            const mouse = new THREE.Vector2();
            let state = 'SEED';
            let stateTimer = 0;
            let idleStartTime = 0; // Variable to anchor the IDLE state movement
            const flashOverlay = document.getElementById('flash-overlay');

            document.addEventListener('mousemove', (e) => {
                mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
            });

            function animate() {
                requestAnimationFrame(animate);
                const delta = clock.getDelta();
                const time = clock.getElapsedTime();
                stateTimer += delta;

                if (state === 'SEED') {
                    const vibration = Math.sin(time * 50) * 0.1;
                    bangSeed.scale.setScalar(1 + vibration);
                    if (stateTimer > 0.5) {
                        state = 'BANG';
                        bangSeed.visible = false;
                        bangParticles.visible = true;
                        flashOverlay.style.transition = "opacity 0.1s ease-out";
                        flashOverlay.style.opacity = "1";
                        stateTimer = 0; // Reset timer for controlled bang duration
                    }
                }
                else if (state === 'BANG') {
                    const positions = bangParticles.geometry.attributes.position.array;
                    for (let i = 0; i < bangCount; i++) {
                        positions[i * 3] += bangVel[i * 3]; positions[i * 3 + 1] += bangVel[i * 3 + 1]; positions[i * 3 + 2] += bangVel[i * 3 + 2];
                    }
                    bangParticles.geometry.attributes.position.needsUpdate = true;

                    // Flash fade out starts almost immediately
                    if (stateTimer > 0.1) {
                        flashOverlay.style.transition = "opacity 1.5s ease-out";
                        flashOverlay.style.opacity = "0";
                    }

                    if (stateTimer > 0.7) {
                        state = 'REVEAL';
                        mainSceneGroup.visible = true;
                        stateTimer = 0; // Start reveal timer
                    }
                }
                else if (state === 'REVEAL') {
                    const revealDuration = 2.0;
                    const progress = Math.min(1, stateTimer / revealDuration);
                    // Custom Ease-Out: starts fast, slows down to target
                    const easedProgress = 1 - Math.cos(progress * Math.PI / 2);

                    // 1. Fade out explosion particles (faster fade)
                    bangMat.opacity = THREE.MathUtils.lerp(1.0, 0.0, easedProgress * 2);
                    if (bangMat.opacity <= 0) { bangParticles.visible = false; }

                    // 2. Camera Fly-in (using eased progress)
                    camera.position.z = THREE.MathUtils.lerp(startZ, targetZ, easedProgress);
                    camera.position.y = THREE.MathUtils.lerp(startY, targetY, easedProgress);

                    if (progress >= 1) {
                        state = 'IDLE';
                        // FIX: Capture the current absolute time to anchor the start of IDLE's sinusoidal motion
                        idleStartTime = time;
                        // Ensure camera positions are exactly at the target before starting IDLE motion
                        camera.position.z = targetZ;
                        camera.position.y = targetY;
                    }
                }
                else if (state === 'IDLE') {
                    // Calculate time elapsed *since* IDLE state started (ensures smooth transition)
                    const idleTime = time - idleStartTime;

                    // X/Z motion: Circular orbit, synchronized to start smoothly from transition
                    const orbitSpeed = 0.08;
                    camera.position.x = Math.sin(idleTime * orbitSpeed) * 90 + (mouse.x * 5);
                    camera.position.z = Math.cos(idleTime * orbitSpeed) * 90;

                    // Y motion: Smooth vertical oscillation, synchronized to start smoothly from targetY (25)
                    const wobbleSpeed = 0.15;
                    camera.position.y = targetY + Math.sin(idleTime * wobbleSpeed) * 15 + (mouse.y * 5);
                }

                // Continue moving remaining particles until they are invisible
                if ((state === 'REVEAL' || state === 'IDLE') && bangParticles.visible) {
                    const positions = bangParticles.geometry.attributes.position.array;
                    for (let i = 0; i < bangCount; i++) {
                        positions[i * 3] += bangVel[i * 3]; positions[i * 3 + 1] += bangVel[i * 3 + 1]; positions[i * 3 + 2] += bangVel[i * 3 + 2];
                    }
                    bangParticles.geometry.attributes.position.needsUpdate = true;
                }

                camera.lookAt(0, 0, 0);
                holeMat.uniforms.uTime.value = time;

                // Animate Background Moons (Gentle Rotation)
                bgMoons.forEach((moon, idx) => {
                    moon.rotation.y = time * 0.05 * (idx === 0 ? 1 : -1);
                    // Update planet shader time uniform
                    if (moon.material.uniforms.uTime) {
                        moon.material.uniforms.uTime.value = time;
                    }
                });

                const pos = accretionDisk.geometry.attributes.position.array;
                for (let i = 0; i < pCount; i++) {
                    pAngle[i] += pSpeed[i];
                    const r = pRadius[i];
                    const wobble = Math.sin(time * 3 + r * 0.2) * (r * 0.03 * Math.max(0, 1 - r / 60));
                    const x = Math.cos(pAngle[i]) * r; const z = Math.sin(pAngle[i]) * r; const i3 = i * 3;
                    pos[i3] = x; pos[i3 + 1] = wobble; pos[i3 + 2] = z;
                }
                accretionDisk.geometry.attributes.position.needsUpdate = true;
                stars.rotation.y = time * 0.01;
                composer.render();
            }

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
                composer.setSize(window.innerWidth, window.innerHeight);
            });

            window.onload = function () {
                animate();
            }
        </script>
        =======
        <h1>Hello, World!</h1>
        <p>This is a simple paragraph on my first webpage. ggg</p>
        >>>>>>> 65e0f5602604ee26eb319ec3633c38f875183d55
</body>

</html>